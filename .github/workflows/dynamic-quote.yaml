name: Dynamic Quote Update

on:
  schedule:
    - cron: '*/2 * * * *'  # Runs every 2 minutes
  workflow_dispatch:
  push:
    branches: [ main ]

permissions:
  contents: write

jobs:
  update-quote:
    runs-on: ubuntu-latest
    name: Update Dynamic Quote
    steps:
      - uses: actions/checkout@v4

      - name: Generate Random Quote
        id: quote
        run: |
          # Array of inspiring tech/programming quotes
          quotes=(
            "\"Code is like humor. When you have to explain it, it's bad.\" â€“ Cory House"
            "\"First, solve the problem. Then, write the code.\" â€“ John Johnson"
            "\"Experience is the name everyone gives to their mistakes.\" â€“ Oscar Wilde"
            "\"In order to be irreplaceable, one must always be different.\" â€“ Coco Chanel"
            "\"Java is to JavaScript what car is to Carpet.\" â€“ Chris Heilmann"
            "\"Knowledge is power.\" â€“ Francis Bacon"
            "\"Sometimes it pays to stay in bed on Monday, rather than spending the rest of the week debugging Monday's code.\" â€“ Dan Salomon"
            "\"Perfection is achieved not when there is nothing more to add, but rather when there is nothing more to take away.\" â€“ Antoine de Saint-Exupery"
            "\"Code never lies, comments sometimes do.\" â€“ Ron Jeffries"
            "\"Give a man a program, frustrate him for a day. Teach a man to program, frustrate him for a lifetime.\" â€“ Muhammad Waseem"
            "\"If debugging is the process of removing software bugs, then programming must be the process of putting them in.\" â€“ Edsger Dijkstra"
            "\"Measuring programming progress by lines of code is like measuring aircraft building progress by weight.\" â€“ Bill Gates"
            "\"Talk is cheap. Show me the code.\" â€“ Linus Torvalds"
            "\"The best error message is the one that never shows up.\" â€“ Thomas Fuchs"
            "\"Simplicity is the ultimate sophistication.\" â€“ Leonardo da Vinci"
            "\"Make it work, make it right, make it fast.\" â€“ Kent Beck"
            "\"The most important property of a program is whether it accomplishes the intention of its user.\" â€“ C.A.R. Hoare"
            "\"Programming isn't about what you know; it's about what you can figure out.\" â€“ Chris Pine"
            "\"The only way to learn a new programming language is by writing programs in it.\" â€“ Dennis Ritchie"
            "\"Any fool can write code that a computer can understand. Good programmers write code that humans can understand.\" â€“ Martin Fowler"
            "\"Programs must be written for people to read, and only incidentally for machines to execute.\" â€“ Harold Abelson"
            "\"Software is a great combination between artistry and engineering.\" â€“ Bill Gates"
            "\"The computer was born to solve problems that did not exist before.\" â€“ Bill Gates"
            "\"Innovation distinguishes between a leader and a follower.\" â€“ Steve Jobs"
            "\"Technology is best when it brings people together.\" â€“ Matt Mullenweg"
          )
          
          # Get random quote
          random_index=$((RANDOM % ${#quotes[@]}))
          selected_quote="${quotes[$random_index]}"
          
          # Get current timestamp
          timestamp=$(date '+%B %d, %Y at %I:%M %p UTC')
          
          echo "quote=$selected_quote" >> $GITHUB_OUTPUT
          echo "timestamp=$timestamp" >> $GITHUB_OUTPUT

      - name: Update README with new quote
        run: |
          # Read the current README
          readme_content=$(cat README.md)
          
          # Create the new quote section
          new_quote_section="### ðŸ’¡ *${{ steps.quote.outputs.quote }}*

*Last updated: ${{ steps.quote.outputs.timestamp }}*"
          
          # Use sed to replace the quote section
          # Find the line with the quote and replace until the next section
          sed -i.bak '/<!--DYNAMIC_QUOTE:start-->/,/<!--DYNAMIC_QUOTE:end-->/{
            /<!--DYNAMIC_QUOTE:start-->/!{
              /<!--DYNAMIC_QUOTE:end-->/!d
            }
          }' README.md
          
          # Insert the new quote
          sed -i.bak '/<!--DYNAMIC_QUOTE:start-->/a\
'"$new_quote_section"'
' README.md
          
          # Clean up backup file
          rm README.md.bak

      - name: Commit changes
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git add README.md
          if git diff --staged --quiet; then
            echo "No changes to commit"
          else
            git commit -m "ðŸ’­ Update dynamic quote [skip ci]"
            git push
          fi
